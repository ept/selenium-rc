<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
  <head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>JsUnit Utility Tests</title>
    <link rel="stylesheet" type="text/css" href="jsunit/css/jsUnitStyle.css">
<script language="JavaScript" type="text/javascript" src="/jsunit/app/jsUnitCore.js"></script>
<script language="JavaScript" type="text/javascript" src="/jsmock/mock.js"></script>
<script language="JavaScript" type="text/javascript" src="/selenium-api.js"></script>
<script language="JavaScript" type="text/javascript" src="/htmlutils.js"></script>
<script language="JavaScript" type="text/javascript">

    function testNullIsReturnedForUnknownCommands() {
        var commandFactory = new CommandFactory();
        assertNull(commandFactory.getCommandHandler("unknown"));
    }

    function testActionsAreTypedAndAvailableAfterRegistrationInCommandFactory() {
        var commandFactory = new CommandFactory();
        commandFactory.registerAction("myAction", "actionFunction");

        var myAction = commandFactory.getCommandHandler("myAction");
        assertNotNull(myAction);
        assertEquals(CommandHandler, myAction.constructor);
        assertEquals("actionFunction", myAction.executor);
        assertEquals("action", myAction.type);
    }

    function testAssertsAreTypedAndAvailableAfterRegistrationInCommandFactory() {
        var commandFactory = new CommandFactory();
        commandFactory.registerAssert("assertFoo", "assertFunction", true);

        var myAssert = commandFactory.getCommandHandler("assertFoo");
        assertNotNull(myAssert);
        assertEquals(CommandHandler, myAssert.constructor);
        assertEquals("assertFunction", myAssert.executor);
        assertEquals("assert", myAssert.type);
        assertTrue(myAssert.haltOnFailure);
    }

    function testHaltOnFailureDefaultsToFalse() {
        var commandFactory = new CommandFactory();
        commandFactory.registerAssert("doHalt", "assertFunction", true);
        commandFactory.registerAssert("dontHalt", "assertFunction");

        assertTrue(commandFactory.getCommandHandler("doHalt").haltOnFailure);
        assertFalse(commandFactory.getCommandHandler("dontHalt").haltOnFailure);
    }

    function testAllMethodsWithDoPrefixAreRegisteredAsActionsByRegisterAll() {
        var actionSet = {doAnAction: "action1", doAnotherAction: "action2", dontRegister: "another"};
        var commandFactory = new CommandFactory();
        commandFactory.registerAll(actionSet);

        assertNull(commandFactory.getCommandHandler("dontRegister"));
        assertNull(commandFactory.getCommandHandler("notEvenClose"));

        assertEquals("action1", commandFactory.getCommandHandler("anAction").executor);
        assertEquals("action2", commandFactory.getCommandHandler("anotherAction").executor);
    }

    function testAllMethodsWithAssertPrefixAreRegisteredForAssertAndVerifyByRegisterAll() {
        var actionSet = {assertSomething: "assert1", assertSomeOtherThing: "assert2", assertionOther: "shouldn't register"};
        var commandFactory = new CommandFactory();
        commandFactory.registerAll(actionSet);

        assertNull(commandFactory.getCommandHandler("assertionOther"));
        assertNull(commandFactory.getCommandHandler("notEvenClose"));

        var myAssert = commandFactory.getCommandHandler("assertSomething");
        assertEquals("assert1", myAssert.executor);
        assertTrue(myAssert.haltOnFailure);
        assertEquals("assert", myAssert.type);

        var myVerify = commandFactory.getCommandHandler("verifySomething");
        assertEquals("assert1", myVerify.executor);
        assertFalse(myVerify.haltOnFailure);
        assertEquals("assert", myVerify.type);

        assertEquals("assert2", commandFactory.getCommandHandler("assertSomeOtherThing").executor);
        assertEquals("assert2", commandFactory.getCommandHandler("verifySomeOtherThing").executor);
    }
</script>
  </head>

  <body>
    <h1>FitRunner component tests</h1>

    <p>This page contains tests for different components in the FitRunner. To see them, take a look at the source. To run them, load this file via JsUnit's testRunner.html</p>
  </body>
</html>
