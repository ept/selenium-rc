<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
  <head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>BrowserBot tests</title>
    <link rel="stylesheet" type="text/css" href="/jsunit/css/jsUnitStyle.css">
<script language="JavaScript" type="text/javascript" src="/jsunit/app/jsUnitCore.js"></script>
<script language="JavaScript" type="text/javascript" src="/jsmock/mock.js"></script>

<script language="JavaScript" type="text/javascript" src="/htmlutils.js"></script>
<script language="JavaScript" type="text/javascript" src="/selenium-api.js"></script>
<script language="JavaScript" type="text/javascript">
function setUp() {
    mockPageBot = new Mock();

    mockBrowserBot = new Mock();
    mockBrowserBot.currentPage = mockPageBot;

    selenium = new Selenium(mockBrowserBot);
    assertEquals(mockPageBot, selenium.page());
}

function verify() {
    mockBrowserBot.verify();
    mockPageBot.verify();
}

// Tests for Element actions
function testClickElementWithoutCallback() {
    mockPageBot.expects("findElement", "id").returns("elementToClick");
    mockPageBot.expects("clickElement", "elementToClick", undefined);

    selenium.clickElement("id");
    verify();
}

function testClickElementWithoutCallback() {
    mockPageBot.expects("findElement", "id").returns("elementToClick");
    mockPageBot.expects("clickElement", "elementToClick", "function");

    selenium.clickElement("id", "function");
    verify();
}

function testType() {
    mockPageBot.expects("findElement", "id").returns("elementToType");
    mockPageBot.expects("replaceText", "elementToType", "new text");

    selenium.type("id", "new text");
    verify();
}

function testSelect() {
    mockPageBot.expects("findElement", "id").returns("selectElement");
    mockPageBot.expects("selectOptionWithLabel", "selectElement", "option text");


    selenium.select("id", "option text");
    verify();
}

// Browser actions
function testOpen() {
    mockBrowserBot.expects("openLocation", "new/location", "callbackFunction");

    selenium.open("new/location", "callbackFunction");
    verify();
}

function testSelectWindow() {
    mockBrowserBot.expects("selectWindow", "windowName");

    selenium.selectWindow("windowName");
    verify();
}

// Verify functions
function testVerifyLocationSuccess() {
    mockPageBot.expectsProperty("location").returns("foo");
    selenium.verifyLocation("foo");
    verify();
}

function testVerifyLocationFailed() {
    mockPageBot.expectsProperty("location").returns("foo");
    try {
        selenium.verifyLocation("bar");
        fail("Verify location should have failed");
    }
    catch (e) {
        // Expected
    }
}

// TODO: Tests for the rest of the API methods...
</script>
  </head>
  <body>Selenium BrowserBot Tests</body>
</html>
