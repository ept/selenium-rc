<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Selenium Remote Control: Building from Source</title>
<link rel="stylesheet" href="default.css" type="text/css" />
</head>
<body>
<p>Building Selenium Remote Control from the source repository can be a bit tricky.  Selenium Remote Control is written in many languages; that means that in order to do a full build of Selenium Remote Control, you'll need to have interpreters installed for each supported language (Java, C#, Python, Ruby, and Perl).</p>

<p>Fortunately, there are ways around this that can make it easier for you if you only want to work on just one part of SRC.</p>

<ul>
	<li>IEDoc.js, IEDoc.xml and XSLT</li>
	<li>Developing the Java Selenium Server and the Java Client Driver</li>
	<li>Developing in Java: The Easy Way</li>
	<li>Developing in Java: The Real Way</li>
	<ul>
		<li>Java Selenium RC Maven Projects</li>
		<li>Eclipse Projects</li>
	</ul>
	<li>Developing the Other Client Drivers</li>
	<ul>
		<li>Developing the .NET Client Driver</li>
		<li>Developing the Ruby Client Driver</li>
		<li>Developing the Python Client Driver</li>
		<li>Developing the Perl Client Driver</li>
	</ul>
	<li>Developing a Totally New Client Driver</li>
	<ul>
		<li>Auto-generating Your Client Driver Using XSLT</li>
	</ul>
</ul>

<h2>IEDoc.js, IEDoc.xml and XSLT</h2>
<p>Most of the code for the supported client drivers is generated using XSLT.  The XML file is generated based on the current latest Selenium Core JavaScript files, so our client drivers never get out of date.  This also allows us to embed API documentation into the generated Client Driver code, so we can use standard documentation generation tools like JavaDoc, NDoc, (E|Hap)Pydoc, RDoc or PerlDoc to present end users with documentation with they which will be familiar.</p>

<p>Specifically, "selenium-api.js" is a file in Selenium Core that contains a complete definition of every Selenium command.  We've written a tool called "iedoc.js" that parses selenium-api.js and generates XML output from it (called iedoc.xml).  We call it "iedoc.js" because it only works on Windows, using cscript.exe, on the command line.  It's written in JavaScript because that way we don't have to write our own JavaScript parser: we just run selenium-api.js in JavaScript and inspect the Selenium prototype object to see what methods were added to it.  (It doesn't/can't work this way in Mozilla/Firefox; see <a href="http://jira.openqa.org/browse/SRC-39">SRC-39</a> for details).

<p>For an example of IEDoc.xml, you can look inside the Selenium Server jar itself.  (JAR files are just zip files, and can be extracted with any standard unzip tool.)  "iedoc.xml" should be embedded inside selenium-server.jar in the /selenium directory. i.e. selenium-server.jar!/selenium/iedoc.xml.</p>

<h2>Developing the Java Selenium Server and the Java Client Driver</h2>

<p>There are two ways to do development on the Java Selenium Server and the Java Client Driver: the Easy way and the Real way.  (Official Selenium developers have to use the Real way.)</p>

<p>If you're just developing one of the other Client Drivers, you don't need to develop in Java at all!

<h3>Developing in Java: The Easy Way</h3>

<p>The source code for the Java Selenium Server and the Java Client Driver are distributed inside the .zip file with every Selenium RC release since 0.7.2.  We also include <a href="http://www.eclipse.org/">Eclipse</a> project files so you can easily load up these projects in Eclipse.  The only tool you'll need to work this way is Eclipse itself.

<p>Download the release, unzip it, and Import the project you want to work on in Eclipse.  When you're done crafting your fabulous new feature or crucial bug fix, just submit a patch in our JIRA and we'll integrate it and test it with the real system.</p>

<p>Note that in the Java Client Driver, Selenium.java and DefaultSelenium.java are both autogenerated.  These files are not checked in (and must not be checked in, or they'll get out of date).  So if you submit a patch to us in either of those files, we may not be able to integrate it as easily.  We'll still accept it, though!</p>

<h3>Developing in Java: The Real Way</h3>

<p><a name="tools"/>The Java Selenium Server is officially built using <a href="http://ant.apache.org/">Ant</a> and <a href="http://maven.apache.org/">Maven</a>.  (We would just use Maven, but there are bugs in Maven that require us to workaround them in Ant.)</p>

<p>We're currently set up to use JDK 1.4.2_06, Maven 2.0.2 (though any 2.0.x version should do) and Ant 1.6.5.  To verify that you've set them up and installed them correctly, run the following commands from the command line:</p>

<pre>
&gt; java -version
java version "1.4.2_06"
Java(TM) 2 Runtime Environment, Standard Edition (build 1.4.2_06-b03)
Java HotSpot(TM) Client VM (build 1.4.2_06-b03, mixed mode)
&gt; ant -version
Apache Ant version 1.6.5 compiled on June 2 2005
&gt; mvn -version
Maven version: 2.0.2
</pre>

<p>To build, start by pulling down the Selenium RC source from our <a href="http://www.openqa.org/selenium-rc/cvs.action">Selenium RC source repository</a> (http://svn.openqa.org/svn/selenium-rc/trunk).  You'll also need to pull down the Selenium Core source from the <a href="http://www.openqa.org/selenium/cvs.action">Selenium Core source repository</a> (http://svn.openqa.org/svn/selenium/trunk).</p>

<p>Specifically, we'll need the Selenium Core code in /svn/selenium/trunk/code/javascript.  That's the <b>Core JavaScript Path</b>, which you'll have to specify manually in order to kick off your build.</p>

<p>From the selenium-rc-trunk directory, you should be able to kick off a build of everything in there from the command-line by typing <code>ant maven</code> and specifying the Core JavaScript Path like this:

<p><code>ant maven -Dcore.javascript.path=c:\svn\selenium\trunk\code\javascript</code></p>

<p>That will kick off Maven builds of all three of our Maven components, one after the other.</p>

<h3>Java Selenium RC Maven Projects</h3>

<P>There are three Maven projects in the Java part of Selenium Remote Control:</P>

<OL>
	<LI>selenium-core (trunk/javascript-core): makes a full copy of the Core JavaScript Path, runs IEDoc, and republishes the whole thing as a Maven project.</LI>
	<li>selenium-server (trunk/server): Builds selenium-server.jar; this includes all the code to launch browsers on various operating systems and the client-configured proxy.</li>
	<li>selenium-java-client-driver (trunk/clients/java): Runs the XSLT to generate DefaultSelenium.java and Selenium.java.  Acts as a simple HTTP request system, no more complicated than any of the other drivers.</li>
</ol>

<p>-core has no explicit Maven dependencies, but it does require you to specify the -Dcore.javascript.path property to locate the JavaScript to copy, and it will attempt to run iedoc.js using cscript.exe, which must be available in your Path.  Obviously, this won't work on any operating system except Windows.  If this annoys you, I encourage you to devote some thought to <a href="http://jira.openqa.org/browse/SRC-39">SRC-39</a>. ;-)</p>

<p>-server depends on -core, Jetty, and Ant itself (we use Ant as a library as well as a build tool).  In so doing, it uses the Codehaus <a href="http://mojo.codehaus.org/dependency-maven-plugin/introduction.html">dependency-maven-plugin</a> to <i>republish</i> selenium-core and jetty within its own jar.  (Hence, it depends on selenium-core and jetty at the "provided" scope, meaning that projects that depend on selenium-server should <i>not</i> explicitly depend on -server's dependencies.)</p>

<p>Note that dependency-maven-plugin is <i>not</i> a standard part of Maven, and it has an important bug, <a href="http://jira.codehaus.org/browse/MDEP-1">MDEP-1</a>, which prevents us from connecting our Maven projects into a multi-project uber-build.</p>

<p>java-client-driver depends on -server only at test time (i.e. at the "test" scope).  Philosophically, of course, it depends on the Selenium Server in order to do its work, but it doesn't necessarily need the selenium-server.jar to be loaded up in the same classpath with it: the Selenium Server could easily be installed on another machine entirely and the Java Client Driver would still work.</p>

<p><b>To change Selenium.java or DefaultSelenium.java, you <i>must</i> make these changes in the XSLT file trunk/clients/java/iedoc2java.xml.</b>  These files are not checked in (and must not be checked in, or they'll get out of date).</p>

<h3>Eclipse Projects</h3>

<p>We have checked in Eclipse projects for all three of our Maven projects, but they won't (can't) work until you've done a successful Maven build first.  The easiest way to do this is to kick off the "ant maven" build at the top level (see above).  If you want to do things by hand, you can also kick off the builds manually by running "mvn install" at every level individually:</p>

<ol>
	<li>trunk</li>
	<li>trunk/javascript-core</li>
	<li>trunk/server</li>
	<li>trunk/clients/java</li>
</ol>

<p>Once that's done, you should be able to load up all of your Eclipse projects in Eclipse and build everything.</p>

<h2><a name="extract-xml" />Developing the Other Client Drivers</h2>

<p>If you're developing the other Client Drivers, (C#, Python, Ruby, Perl) you don't need to build your own Selenium Server jar; in fact, you don't need to do anything at all at the top level... you can do everything you need to do from the trunk/clients subdirectory.</p>

<p>You do however still need a working copy of <a href="#tools">Ant</a>, which also acts as our XSLT runner.  You'll also need to have <i>some</i> copy of Selenium Server around so the client driver build scripts can automatically extract iedoc.xml from it, as well as automatically start/stop the server in order to run their automated tests.</p>

<p>To make sure this works correctly, try running the following command in the trunk/clients directory:</p>

<p><code>&nbsp;&nbsp;&nbsp;ant extract-xml -Dselenium-server.jar=c:\path\to\my\selenium-server.jar</code></p>

<p>(If you've built selenium-server.jar locally using Maven, you can omit the -Dselenium-server part; we'll just fish the file out of your local repository and use that directly.)</p>

<p>If all goes well, the Ant script should automatically extract iedoc.xml and drop it in the current directory.  If this doesn't work, none of the other client driver build scripts will work.</p>

<h3>Developing the .NET Client Driver</h3>

<p>The .NET Client Driver is implemented in C#.  A solution file is available with every build of Selenium RC that you can open up in Visual Studio .NET 2003.  At this time, the .NET Client Driver can only be built using VS 2003 and only on Windows.  If this annoys you, I encourage you to take a look at <a href="http://jira.openqa.org/browse/SRC-40">SRC-40</a> (.NET build scripts should not depend on Visual Studio) and <a href="http://jira.openqa.org/browse/SRC-41">SRC-41</a> (We should make a Mono-compatible .NET driver).</p>

<p>To automatically generate the sources you need, you can navigate to trunk/clients/dotnet and run:</p>

<p>&nbsp;&nbsp;&nbsp;<code>ant generate-sources -Dselenium-server.jar=c:\path\to\my\selenium-server.jar</code></p>

<p>This will only work if <code><a href="#extract-xml">ant extract-xml</a></code> worked from the trunk/clients directory.  Again, you can omit the explicit reference to selenium-server.jar if you've built it locally using Maven.</p>

<p><b>To change ISelenium.cs or DefaultSelenium.cs, you <i>must</i> make these changes in the XSLT file trunk/clients/java/iedoc2csharp.xml.</b>  These files are not checked in (and must not be checked in, or they'll get out of date).</p>

<p>To do a full build-and-test from the command line, you can run <code>ant all</code> to do the build; again, you'll need to specify the location of selenium-server.jar if you haven't built it locally with Maven.  This will automatically launch NDoc to generate documentation based on iedoc.xml.</p>

<h3>Developing the Ruby Client Driver</h3>

<p>To build the Ruby Driver, we expect Ruby to appear on your PATH environment variable.  (You can also specify a "ruby.executable" property to the Ant script if you'd like to put your Ruby in a non-standard location.)</p>

<p>To automatically generate the sources you need, you can navigate to trunk/clients/ruby and run:</p>

<p>&nbsp;&nbsp;&nbsp;<code>ant generate-sources -Dselenium-server.jar=c:\path\to\my\selenium-server.jar</code></p>

<p>This will only work if <code><a href="#extract-xml">ant extract-xml</a></code> worked from the trunk/clients directory.  Again, you can omit the explicit reference to selenium-server.jar if you've built it locally using Maven.

<p><b>To change selenium.rb, you <i>must</i> make these changes in the XSLT file trunk/clients/java/iedoc2ruby.xml.</b>  selenium.rb is not checked in (and must not be checked in, or it'll get out of date).</p>

<p>To do a full build-and-test from the command line, you can run <code>ant all</code> to do the build; again, you'll need to specify the location of selenium-server.jar if you haven't built it locally with Maven.  This will automatically launch RDoc to generate documentation based on iedoc.xml.</p>

<h3>Developing the Python Client Driver</h3>

<p>To build the Python Driver, we expect Python to appear on your PATH environment variable.  (You can also specify a "python.executable" property to the Ant script if you'd like to put your Python in a non-standard location.  Also see below for more information about generating doc.)</p>

<p>To automatically generate the sources you need, you can navigate to trunk/clients/python and run:</p>

<p>&nbsp;&nbsp;&nbsp;<code>ant generate-sources -Dselenium-server.jar=c:\path\to\my\selenium-server.jar</code></p>

<p>This will only work if <code><a href="#extract-xml">ant extract-xml</a></code> worked from the trunk/clients directory.  Again, you can omit the explicit reference to selenium-server.jar if you've built it locally using Maven.

<p><b>To change selenium.py, you <i>must</i> make these changes in the XSLT file trunk/clients/java/iedoc2python.xml.</b>  selenium.py is not checked in (and must not be checked in, or it'll get out of date).</p>

<p>To do a full build-and-test from the command line, you can run <code>ant all</code> to do the build; again, you'll need to specify the location of selenium-server.jar if you haven't built it locally with Maven.</p>

<p>By default, "ant all" will automatically launch PyDoc (which comes with Python) to generate documentation based on iedoc.xml.  However, PyDoc doesn't allow any text formatting, and it looks a little plain.  If you want to generate your documentation using <a href="http://epydoc.sourceforge.net/">epydoc</a>, you can do so like this:</p>

<p><code>&nbsp;&nbsp;&nbsp;ant doc -Duse.epydoc=1 -Depydoc.script=c:\Python24\scripts\epydoc.py</code></p>

<p>iedoc2python.xml generates inline documentation as <a href="http://docutils.sourceforge.net/rst.html">reStructuredText</a>; to generate good looking doc you'll also need to install <a href="http://docutils.sourceforge.net/">docutils</a>.

<h3>Developing the Perl Client Driver</h3>

<p>To build the Perl Driver, we expect Perl to appear on your PATH environment variable.  (You can also specify a "perl.executable" property to the Ant script if you'd like to put your Perl in a non-standard location.)</p>

<p>To automatically generate the sources you need, you can navigate to trunk/clients/perl and run:</p>

<p>&nbsp;&nbsp;&nbsp;<code>ant generate-sources -Dselenium-server.jar=c:\path\to\my\selenium-server.jar</code></p>

<p>This will only work if <code><a href="#extract-xml">ant extract-xml</a></code> worked from the trunk/clients directory.  Again, you can omit the explicit reference to selenium-server.jar if you've built it locally using Maven.

<p><b>To change WWW/Selenium.pm, you <i>must</i> make these changes in the XSLT file trunk/clients/java/iedoc2perl.xml.</b>  Selenium.pm is not checked in (and must not be checked in, or it'll get out of date).</p>

<p>To do a full build-and-test from the command line, you can run <code>ant all</code> to do the build; again, you'll need to specify the location of selenium-server.jar if you haven't built it locally with Maven.  This will automatically launch pod2html to generate documentation based on iedoc.xml.</p>

<h2>Developing a Totally New Client Driver</h3>

<p>Writing your own Client Driver is as easy as pie.  All you need to automate tasks in the browser is to send HTTP commands to the Selenium Server, and to parse their responses.</p>

<p>Selenium Commands are sent to the server with HTTP Parameters, like this:</p>

<p>&nbsp;&nbsp;&nbsp;<tt>http://localhost:4444/selenium-server/driver/?cmd=getNewBrowserSession&1=*firefox&2=http%3A%2F%2Fgoogle.com</tt></p>

<p>If the command is an "Accessor" (a command designed to return data), then the response will begin with "OK," followed by the data to be sent, or it will contain an error message.  A normal response to this command might be:</p>

<p>&nbsp;&nbsp;&nbsp;<tt>OK,123125245345</tt></p>

<p>You'll need to keep track of that string to use it again later, just like you did in the interactive tutorial.</p>

<p>Some commands can return more complicated values, like arrays of strings.  Arrays of strings are encoded in a comma-delimited format...  the values themselves are separated by "," characters.  If one of the values itself contains a comma, it will prepend a backslash before the comma ("escaping" the comma), like this: "\,".  If the value contains a backslash, the Server will escape the backslash, like this: "\\".</p>

<p>Normally your workflow will be:</p>

<ol>
<li>Get a new browser session with "getNewBrowserSession"</li>
<li>Send some commands using that session</li>
<li>close the browser session with "testComplete"</li>
</ol>

<p>We also have a detailed write-up of the <a href="http://wiki.openqa.org/display/SRC/Specifications+for+Selenium+Remote+Control+Client+Driver+Protocol">Selenium Remote Control Client Driver Protocol (SRC-CDP)</a> full of details, but that should be enough to get you started.</p>

<p>If you're familiar with at least one of the officially supported Client Drivers, you may benefit from viewing their <a href="http://www.openqa.org/selenium-rc/cvs.action">source code</a> as an example.</p>

<h3>Auto-generating Your Client Driver Using XSLT</h3>

<p>If you want to get fancy, you can automatically generate your Client Driver based on an XML representation of the Selenium API.  All of our officially supported Client Drivers automatically generate themselves.</p>

<p>If you want to see examples of XSLT to generate our officially supported drivers, look here:

<ul>
<li><a href="http://svn.openqa.org/fisheye/viewrep/~raw,r=HEAD/selenium-rc/trunk/clients/java/iedoc2java.xml">Java</a>
<li><a href="http://svn.openqa.org/fisheye/viewrep/~raw,r=HEAD/selenium-rc/trunk/clients/dotnet/iedoc2csharp.xml">C#</a>
<li><a href="http://svn.openqa.org/fisheye/viewrep/~raw,r=HEAD/selenium-rc/trunk/clients/python/iedoc2python.xml">Python</a>
<li><a href="http://svn.openqa.org/fisheye/viewrep/~raw,r=HEAD/selenium-rc/trunk/clients/ruby/iedoc2ruby.xml">Ruby</a>
<li><a href="http://svn.openqa.org/fisheye/viewrep/~raw,r=HEAD/selenium-rc/trunk/clients/perl/iedoc2perl.xml">Perl</a>
</ul>

</body></html>